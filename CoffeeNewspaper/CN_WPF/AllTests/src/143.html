<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>e:\githubproject\coffeenewspaper\coffeenewspaper\cn_wpf\pages\basepage.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Windows.Controls;
using CN_Core;
using CN_Presentation.ViewModel.Base;

namespace CN_WPF
{
    /// &lt;summary&gt;
    /// The base page for all pages to gain base functionality
    /// &lt;/summary&gt;
    public class BasePage : UserControl
    {
        #region Private Member

        /// &lt;summary&gt;
        /// The View Model associated with this page
        /// &lt;/summary&gt;
        private object mViewModel;

        #endregion

        #region Public Properties


        /// &lt;summary&gt;
        /// The View Model associated with this page
        /// &lt;/summary&gt;
        public object ViewModelObject
        {
            get =&gt; mViewModel;
            set
            {
                // If nothing has changed, return
                if (mViewModel == value)
                    return;

                // Update the value
                mViewModel = value;

                // Fire the view model changed method
                OnViewModelChanged();

                // Set the data context for this page
                DataContext = mViewModel;
            }
        }

        #endregion
        
        /// &lt;summary&gt;
        /// Fired when the view model changes
        /// &lt;/summary&gt;
        protected virtual void OnViewModelChanged()
        {

        }
    }

    /// &lt;summary&gt;
    /// A base page with added ViewModel support
    /// &lt;/summary&gt;
    public class BasePage&lt;VM&gt; : BasePage
        where VM : BaseViewModel, new()
    {
        #region Public Properties

        /// &lt;summary&gt;
        /// The view model associated with this page
        /// &lt;/summary&gt;
        public VM ViewModel
        {
            get =&gt; (VM)ViewModelObject;
            set =&gt; ViewModelObject = value;
        }

        #endregion

        #region Constructor

        /// &lt;summary&gt;
        /// Default constructor
        /// &lt;/summary&gt;
        public BasePage()
        {
            // Create a default view model

            ViewModel = new VM();
        }

        /// &lt;summary&gt;
        /// Constructor with specific view model
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;specificViewModel&quot;&gt;The specific view model to use, if any&lt;/param&gt;
        public BasePage(VM specificViewModel)
        {
            // Set specific view model
            ViewModel = specificViewModel ?? IoC.Get&lt;VM&gt;();
        }

        #endregion
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[29,20,29,30,0],[31,13,31,14,0],[33,17,33,41,0],[34,21,34,28,0],[37,17,37,36,0],[40,17,40,38,0],[43,17,43,42,0],[44,13,44,14,0],[53,9,53,10,0],[55,9,55,10,0],[71,20,71,39,0],[72,20,72,43,0],[82,9,82,26,0],[83,9,83,10,0],[86,13,86,34,0],[87,9,87,10,0],[93,9,93,46,0],[94,9,94,10,0],[96,13,96,60,0],[97,9,97,10,0]]);
    </script>
  </body>
</html>