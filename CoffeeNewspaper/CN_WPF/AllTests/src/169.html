<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>e:\githubproject\coffeenewspaper\coffeenewspaper\coffeenewspaper_unittest\servicetest\taskservicetest.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using CN_Core;
using CN_Core.Interfaces;
using CN_Core.Interfaces.Repository;
using CN_Core.Interfaces.Service;
using CoffeeNewspaper_UnitTest.DomainTest;
using Ninject;
using NSubstitute;
using NUnit.Framework;

namespace CoffeeNewspaper_UnitTest.ServiceTest
{
    [TestFixture]
    public class TaskServiceTest : ServiceSetupTearDown
    {
        [Test]
        public async Task AddATimeSlice_AddaBiggerSlice_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            var addedTimeslice =
                new CNTimeSlice(now.AddHours(3));
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(1), now.AddHours(2)),
                    new CNTimeSlice(now.AddHours(2), now.AddHours(3).AddMilliseconds(-1))
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));

            //Act
            await targetService.AddATimeSlice(assesTask.TaskId, addedTimeslice);

            //Assert
            mockTaskDataStore.Received()
                .ExpandTaskTime(Arg.Is&lt;CNTask&gt;(
                    x =&gt; x.TaskId == assesTask.TaskId), now.AddHours(1), null);
            mockTimesliceDataStore.Received()
                .AddTimeSlice(Arg.Is&lt;CNTimeSlice&gt;(x =&gt;
                    x.Equals(addedTimeslice) &amp;&amp; x.Task.TaskId == assesTask.TaskId));
        }

        [Test]
        public async Task AddATimeSlice_AddaSmallerSlice_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            var addedTimeslice = new CNTimeSlice(now.AddHours(2), now.AddHours(3).AddMilliseconds(-1));
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(1), now.AddHours(2)),
                    new CNTimeSlice(now.AddHours(3))
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));

            //Act
            await targetService.AddATimeSlice(assesTask.TaskId, addedTimeslice);

            //Assert
            mockTaskDataStore.Received()
                .ExpandTaskTime(Arg.Is&lt;CNTask&gt;(
                    x =&gt; x.TaskId == assesTask.TaskId), now.AddHours(1), null);
            mockTimesliceDataStore.Received()
                .AddTimeSlice(Arg.Is&lt;CNTimeSlice&gt;(x =&gt;
                    x.Equals(addedTimeslice) &amp;&amp; x.Task.TaskId == assesTask.TaskId));
        }

        [Test]
        public async Task AddATimeSlice_TaskNotExist_Fail()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();

            //Assess
            mockTaskDataStore.GetTask(1).Returns(Task.FromResult((CNTask) null));

            //Act
            var result = await targetService.AddATimeSlice(1, DomainTestHelper.GetARandomTimeSlice());

            //Assert
            Assert.IsNull(result);
            mockTimesliceDataStore.DidNotReceive().AddTimeSlice(Arg.Any&lt;CNTimeSlice&gt;());
        }

        [Test]
        public void AddATimeSlice_TimeSliceIntercept_Fail()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(1), now.AddHours(2)),
                    new CNTimeSlice(now.AddHours(3))
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));

            //Act
            Assert.ThrowsAsync&lt;TimeSliceInterveneException&gt;(async () =&gt;
                await targetService.AddATimeSlice(assesTask.TaskId, new CNTimeSlice(now.AddHours(4))));

            //Assert
             mockTimesliceDataStore.DidNotReceive().AddTimeSlice(Arg.Any&lt;CNTimeSlice&gt;());
        }

        [Test]
        public async Task GetTaskTimeSlices_TaskNull_ReturnNewEmptyList()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);

            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult((CNTask)null));

            //Act
            var result = await targetService.GetTaskTimeSlices(assesTask.TaskId);

            //Assert
            Assert.IsNotNull(result);
            Assert.AreEqual(0,result.Count);
            await mockTimesliceDataStore.DidNotReceiveWithAnyArgs().GetTimeSliceByTaskID(0);
        }
        [Test]
        public async Task GetTaskTimeSlices_Traverse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);

            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));

            //Act
            await targetService.GetTaskTimeSlices(assesTask.TaskId);

            //Assert
            await mockTimesliceDataStore.Received().GetTimeSliceByTaskID(assesTask.TaskId);
        }
        [Test]
        public async Task DeleteAllTimeSlicesOfTask_TaskIsNull_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);

            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult((CNTask)null));
            
            //Act
            await targetService.DeleteAllTimeSlicesOfTask(assesTask.TaskId);

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs()
                .UpdateTask(assesTask);
             mockTimesliceDataStore.DidNotReceiveWithAnyArgs().DeleteTimeSliceByTask(0);
        }
        [Test]
        public async Task DeleteAllTimeSlicesOfTask_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            var assesChildTask = DomainTestHelper.GetARandomTask(2);
            var assesSufTask = DomainTestHelper.GetARandomTask(3);
            assesTask.ChildTasks.Add(assesChildTask);
            assesTask.SufTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = assesTask,
                PreTaskId = assesTask.TaskId,
                SufTask = assesSufTask,
                SufTaskId = assesSufTask.TaskId
            });
            assesTask.StartTime = now.AddDays(-1);
            assesTask.EndTime = now.AddDays(1);

            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));

            //Act
            await targetService.DeleteAllTimeSlicesOfTask(assesTask.TaskId);

            //Assert
             mockTaskDataStore.Received()
                .UpdateTask(Arg.Is&lt;CNTask&gt;(x=&gt;x.StartTime == null &amp;&amp; x.EndTime == null));
             mockTimesliceDataStore.Received().DeleteTimeSliceByTask(assesTask.TaskId);
        }
        [Test]
        public async Task DeleteTimeSlices_ContainOnlyOneSlice_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            assesTask.StartTime = now.AddHours(1);

            assesTask.EndTime = now.AddHours(2);
            var addedTimeslice =
                new CNTimeSlice(now.AddHours(1), now.AddHours(2))
                {
                    Task = assesTask,
                    TimeSliceId = Guid.NewGuid().ToString(&quot;D&quot;)
                };
            assesTask.UsedTimeSlices =
                new[]
                {
                    addedTimeslice
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));
            mockTimesliceDataStore.GetTimeSliceById(addedTimeslice.TimeSliceId)
                .Returns(Task.FromResult(addedTimeslice));
            //Act
            await targetService.DeleteTimeSlices(addedTimeslice);

            //Assert
             mockTaskDataStore.Received()
                .UpdateStartTaskTime(Arg.Is&lt;CNTask&gt;(x =&gt; x.TaskId == assesTask.TaskId), null);
             mockTaskDataStore.Received()
                .UpdateStartTaskTime(Arg.Is&lt;CNTask&gt;(x =&gt; x.TaskId == assesTask.TaskId), null);
             mockTimesliceDataStore.Received().DeleteTimeSlice(addedTimeslice);
        }

        [Test]
        public async Task DeleteTimeSlices_EndOfTwoSlice_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            assesTask.StartTime = now.AddHours(1);

            assesTask.EndTime = now.AddHours(3).AddMilliseconds(-1);
            var addedTimeslice =
                new CNTimeSlice(now.AddHours(2), now.AddHours(3).AddMilliseconds(-1))
                {
                    Task = assesTask,
                    TimeSliceId = Guid.NewGuid().ToString(&quot;D&quot;)
                };
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(1), now.AddHours(2)),
                    addedTimeslice
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));
            mockTimesliceDataStore.GetTimeSliceById(addedTimeslice.TimeSliceId)
                .Returns(Task.FromResult(addedTimeslice));
            //Act
            await targetService.DeleteTimeSlices(addedTimeslice);

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateStartTaskTime(assesTask, null);
             mockTaskDataStore.Received()
                .UpdateEndTaskTime(Arg.Is&lt;CNTask&gt;(x =&gt; x.TaskId == assesTask.TaskId), now.AddHours(2));
             mockTimesliceDataStore.Received().DeleteTimeSlice(addedTimeslice);
        }
        
        [Test]
        public async Task DeleteTimeSlices_SliceDontExist_Fail()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            assesTask.StartTime = now.AddHours(1);

            assesTask.EndTime = now.AddHours(3).AddMilliseconds(-1);
            var addedTimeslice =
                new CNTimeSlice(now.AddHours(2), now.AddHours(3).AddMilliseconds(-1))
                {
                    Task = assesTask,
                    TimeSliceId = Guid.NewGuid().ToString(&quot;D&quot;)
                };
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(1), now.AddHours(2)),
                    addedTimeslice
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));
            mockTimesliceDataStore.GetTimeSliceById(addedTimeslice.TimeSliceId)
                .Returns(Task.FromResult((CNTimeSlice) null));
            //Act
            var result = await targetService.DeleteTimeSlices(addedTimeslice);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateStartTaskTime(assesTask, null);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateEndTaskTime(assesTask, null);
             mockTimesliceDataStore.DidNotReceiveWithAnyArgs().DeleteTimeSlice(addedTimeslice);
        }

        [Test]
        public async Task DeleteTimeSlices_StartOfTwoSlice_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            assesTask.StartTime = now.AddHours(1);

            assesTask.EndTime = now.AddHours(3).AddMilliseconds(-1);
            var addedTimeslice =
                new CNTimeSlice(now.AddHours(1), now.AddHours(2))
                {
                    Task = assesTask,
                    TimeSliceId = Guid.NewGuid().ToString(&quot;D&quot;)
                };
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(2), now.AddHours(3).AddMilliseconds(-1)),
                    addedTimeslice
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));
            mockTimesliceDataStore.GetTimeSliceById(addedTimeslice.TimeSliceId)
                .Returns(Task.FromResult(addedTimeslice));
            //Act
            await targetService.DeleteTimeSlices(addedTimeslice);

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateEndTaskTime(assesTask, null);
             mockTaskDataStore.Received()
                .UpdateStartTaskTime(Arg.Is&lt;CNTask&gt;(x =&gt; x.TaskId == assesTask.TaskId), now.AddHours(2));
             mockTimesliceDataStore.Received().DeleteTimeSlice(addedTimeslice);
        }
        
        [Test]
        public async Task EndTimeSlice_EndOfTwoSlice_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            var assesChildTask = DomainTestHelper.GetARandomTask(2);
            var assesSufTask = DomainTestHelper.GetARandomTask(3);
            assesTask.ChildTasks.Add(assesChildTask);
            assesTask.SufTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = assesTask,
                PreTaskId = assesTask.TaskId,
                SufTask = assesSufTask,
                SufTaskId = assesSufTask.TaskId
            });
            assesTask.StartTime = now.AddHours(1);

            assesTask.EndTime = now.AddHours(3).AddMilliseconds(-1);
            var addedTimeslice =
                new CNTimeSlice(now.AddHours(2)) {Task = assesTask, TimeSliceId = Guid.NewGuid().ToString(&quot;D&quot;)};
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(1), now.AddHours(2)),
                    addedTimeslice
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));
            mockTimesliceDataStore.GetTimeSliceById(addedTimeslice.TimeSliceId)
                .Returns(Task.FromResult(addedTimeslice));
            //Act
            await targetService.EndTimeSlice(assesTask.TaskId, now.AddHours(4));

            //Assert
             mockTaskDataStore.Received()
                .UpdateEndTaskTime(Arg.Is&lt;CNTask&gt;(x =&gt; x.TaskId == assesTask.TaskId), now.AddHours(4));
            addedTimeslice.EndDateTime = now.AddHours(4);
             mockTimesliceDataStore.Received().UpdateTimeSlice(addedTimeslice);
        }

        [Test]
        public async Task EndTimeSlice_LastSliceStartTimeBiggerThanSetEndTime_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            var assesChildTask = DomainTestHelper.GetARandomTask(2);
            var assesSufTask = DomainTestHelper.GetARandomTask(3);
            assesTask.ChildTasks.Add(assesChildTask);
            assesTask.SufTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = assesTask,
                PreTaskId = assesTask.TaskId,
                SufTask = assesSufTask,
                SufTaskId = assesSufTask.TaskId
            });
            assesTask.StartTime = now.AddHours(1);

            assesTask.EndTime = now.AddHours(3).AddMilliseconds(-1);
            var addedTimeslice =
                new CNTimeSlice(now.AddHours(2)) { Task = assesTask, TimeSliceId = Guid.NewGuid().ToString(&quot;D&quot;) };
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(1), now.AddHours(2)),
                    addedTimeslice
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));
            mockTimesliceDataStore.GetTimeSliceById(addedTimeslice.TimeSliceId)
                .Returns(Task.FromResult(addedTimeslice));
            //Act
            await targetService.EndTimeSlice(assesTask.TaskId, now.AddHours(1));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs()
                .UpdateEndTaskTime(assesTask, now.AddHours(4));
            addedTimeslice.EndDateTime = now.AddHours(4);
             mockTimesliceDataStore.DidNotReceiveWithAnyArgs().UpdateTimeSlice(addedTimeslice);
        }

        [Test]
        public async Task EndTimeSlice_LastSliceEndTimeIsAlreadySet_DoNotingAndReturnTrue()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            var assesChildTask = DomainTestHelper.GetARandomTask(2);
            var assesSufTask = DomainTestHelper.GetARandomTask(3);
            assesTask.ChildTasks.Add(assesChildTask);
            assesTask.SufTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = assesTask,
                PreTaskId = assesTask.TaskId,
                SufTask = assesSufTask,
                SufTaskId = assesSufTask.TaskId
            });
            assesTask.StartTime = now.AddHours(1);

            assesTask.EndTime = now.AddHours(3).AddMilliseconds(-1);
            var addedTimeslice =
                new CNTimeSlice(now.AddHours(2),now.AddHours(5)) { Task = assesTask, TimeSliceId = Guid.NewGuid().ToString(&quot;D&quot;) };
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(1), now.AddHours(2)),
                    addedTimeslice
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));
            mockTimesliceDataStore.GetTimeSliceById(addedTimeslice.TimeSliceId)
                .Returns(Task.FromResult(addedTimeslice));
            //Act
            await targetService.EndTimeSlice(assesTask.TaskId, now.AddHours(4));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs()
                .UpdateEndTaskTime(assesTask, now.AddHours(4));
            addedTimeslice.EndDateTime = now.AddHours(4);
             mockTimesliceDataStore.DidNotReceiveWithAnyArgs().UpdateTimeSlice(addedTimeslice);
        }
        [Test]
        public async Task DeleteTask_EndOfTwoSlice_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var mockTimesliceDataStore = _kernel.Get&lt;ITimeSliceDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var now = DateTime.Now;

            //Assess
            var assesTask = DomainTestHelper.GetARandomTask(1);
            assesTask.StartTime = now.AddHours(1);

            assesTask.EndTime = now.AddHours(3).AddMilliseconds(-1);
            var addedTimeslice =
                new CNTimeSlice(now.AddHours(2)) { Task = assesTask, TimeSliceId = Guid.NewGuid().ToString(&quot;D&quot;) };
            assesTask.UsedTimeSlices =
                new[]
                {
                    new CNTimeSlice(now.AddHours(1), now.AddHours(2)),
                    addedTimeslice
                }.ToList();
            mockTaskDataStore.GetTask(assesTask.TaskId).Returns(Task.FromResult(assesTask));
            mockTimesliceDataStore.GetTimeSliceById(addedTimeslice.TimeSliceId)
                .Returns(Task.FromResult(addedTimeslice));
            //Act
            await targetService.EndTimeSlice(assesTask.TaskId, now.AddHours(4));

            //Assert
             mockTaskDataStore.Received()
                .UpdateEndTaskTime(Arg.Is&lt;CNTask&gt;(x =&gt; x.TaskId == assesTask.TaskId), now.AddHours(4));
            addedTimeslice.EndDateTime = now.AddHours(4);
             mockTimesliceDataStore.Received().UpdateTimeSlice(addedTimeslice);
        }

        [Test]
        public async Task EditATask_TaskNull_Fail()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            

            //Act
            var result = await targetService.EditATask(null);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(null);
        }
        [Test]
        public void EditATask_TaskContentEmpty_Fail()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var task = DomainTestHelper.GetARandomTask(1);
            task.Content = String.Empty;

            //Act
            Assert.ThrowsAsync&lt;ArgumentException&gt;(async()=&gt;await targetService.EditATask(task));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(null);
        }
        [Test]
        public async Task EditATask_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var unitOfWork = _kernel.Get&lt;IUnitOfWork&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);

            //Assess
            unitOfWork.Commit().Returns(Task.FromResult(true));

            //Act
            var result = await targetService.EditATask(mockTask);

            //Assert
            Assert.IsTrue(result);
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x=&gt;x.Content.Equals(mockTask.Content)));
        }
        [Test]
        public async Task GetAllTasks_Traverse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();

            //Assess
            //Act
            await targetService.GetAllTasks();

            //Assert
            await mockTaskDataStore.Received().GetAllTask();
        }
        [Test]
        public async Task GetTaskById_Traverse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();

            //Assess
            //Act
            await targetService.GetTaskById(1);

            //Assert
            await mockTaskDataStore.Received().GetTask(1);
        }
        [Test]
        public async Task CreateATask_Traverse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask();
            //Assess
            //Act
            await targetService.CreateATask(mockTask);

            //Assert
             mockTaskDataStore.Received().AddTask(Arg.Is&lt;CNTask&gt;(x=&gt;x.Content.Equals(mockTask.Content)));
        }

        [Test]
        public void CreateATask_TaskContentNotExists_ThrowException()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask();
            mockTask.Content = string.Empty;
            //Assess
            //Act

            Assert.ThrowsAsync&lt;ArgumentException&gt;(async()=&gt;await targetService.CreateATask(mockTask));

             mockTaskDataStore.DidNotReceiveWithAnyArgs().AddTask(mockTask);
        }

        [Test]
        public async Task DeleteTask_TaskIsNull_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult((CNTask)null));

            //Act
            var result = await targetService.DeleteTask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }
        [Test]
        public async Task DeleteTask_TaskIsDeleted_ReturnTrue()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.IsDeleted = true;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            var result = await targetService.DeleteTask(mockTask.TaskId);

            //Assert
            Assert.IsTrue(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }
        [Test]
        public void DeleteTask_TaskHasChildTasks_ThrowException()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockChildTask = DomainTestHelper.GetARandomTask(2);
            mockTask.ChildTasks.Add(mockChildTask);
            mockTask.IsDeleted = false;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            Assert.ThrowsAsync&lt;TaskHasChildTasksException&gt;(async ()=&gt; await targetService.DeleteTask(mockTask.TaskId)); 

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }
        [Test]
        public void DeleteTask_TaskHasSufTasks_ThrowException()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockSufTask = DomainTestHelper.GetARandomTask(3);
            mockTask.SufTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = mockTask,
                SufTask = mockSufTask
            });
            mockTask.IsDeleted = false;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            Assert.ThrowsAsync&lt;TaskHasSufTasksException&gt;(async () =&gt; await targetService.DeleteTask(mockTask.TaskId));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }

        [Test]
        public async Task DeleteTask_TaskHasSufTasksHasChildTasksForceDelete_ReturnTrue()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockChildTask = DomainTestHelper.GetARandomTask(2);
            mockTask.ChildTasks.Add(mockChildTask);
            var mockSufTask = DomainTestHelper.GetARandomTask(3);
            mockTask.SufTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = mockTask,
                SufTask = mockSufTask
            });
            mockTask.IsDeleted = false;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            await targetService.DeleteTask(mockTask.TaskId,true);
            
            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; (x.TaskId == mockTask.TaskId) &amp;&amp; x.IsDeleted));
        }



        [Test]
        public async Task RecoverATask_TaskIsNull_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult((CNTask)null));

            //Act
            var result = await targetService.RecoverATask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }
        [Test]
        public async Task RecoverATask_TaskIsRecoverAd_ReturnTrue()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.IsDeleted = false;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            var result = await targetService.RecoverATask(mockTask.TaskId);

            //Assert
            Assert.IsTrue(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }
        [Test]
        public async Task RecoverATask_TaskHasSufTasksHasChildTasksForceRecoverA_ReturnTrue()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockChildTask = DomainTestHelper.GetARandomTask(2);
            mockTask.ChildTasks.Add(mockChildTask);
            var mockSufTask = DomainTestHelper.GetARandomTask(3);
            mockTask.SufTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = mockTask,
                SufTask = mockSufTask
            });
            mockTask.IsDeleted = true;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            await targetService.RecoverATask(mockTask.TaskId);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; (x.TaskId == mockTask.TaskId) &amp;&amp; !x.IsDeleted));
        }



        [Test]
        public async Task RemoveTask_TaskIsNull_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult((CNTask)null));

            //Act
            var result = await targetService.RemoveATask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }
        [Test]
        public async Task RemoveTask_TaskIsRemoved_ReturnTrue()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.IsDeleted = false;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            var result = await targetService.RemoveATask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }
        [Test]
        public void RemoveTask_TaskHasChildTasks_ThrowException()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockChildTask = DomainTestHelper.GetARandomTask(2);
            mockTask.ChildTasks.Add(mockChildTask);
            mockTask.IsDeleted = true;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            Assert.ThrowsAsync&lt;TaskHasChildTasksException&gt;(async () =&gt; await targetService.RemoveATask(mockTask.TaskId));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }
        [Test]
        public void RemoveTask_TaskHasSufTasks_ThrowException()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockSufTask = DomainTestHelper.GetARandomTask(3);
            mockTask.IsDeleted = true;
            mockTask.SufTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = mockTask,
                SufTask = mockSufTask
            });
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            Assert.ThrowsAsync&lt;TaskHasSufTasksException&gt;(async () =&gt; await targetService.RemoveATask(mockTask.TaskId));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().RemoveTask(mockTask);
        }

        [Test]
        public async Task RemoveTask_TaskHasSufTasksHasChildTasksForceRemove_ReturnTrue()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockChildTask = DomainTestHelper.GetARandomTask(2);
            mockTask.ChildTasks.Add(mockChildTask);
            mockTask.IsDeleted = true;
            var mockSufTask = DomainTestHelper.GetARandomTask(3);
            mockTask.SufTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = mockTask,
                SufTask = mockSufTask
            });
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            await targetService.RemoveATask(mockTask.TaskId, true);

            //Assert
             mockTaskDataStore.Received().RemoveTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.TaskId == mockTask.TaskId));
        }

        [Test]
        public async Task StartATask_TaskNotExist_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult((CNTask)null));

            //Act
            var result = await targetService.StartATask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }

        [Test]
        public async Task StartATask_TaskIsDeleted_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.IsDeleted = true;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            var result = await targetService.StartATask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }
        [Test]
        public void StartATask_TaskStatusNotValid_ThrowsException()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.DOING;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            Assert.ThrowsAsync&lt;TaskStatusException&gt;(async () =&gt; await targetService.StartATask(mockTask.TaskId));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }
        [Test]
        public async Task StartATask_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var unitOfWork = _kernel.Get&lt;IUnitOfWork&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.TODO;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));
            unitOfWork.Commit().Returns(Task.FromResult(true));
            //Act
            var result = await targetService.StartATask(mockTask.TaskId);

            //Assert
            Assert.IsTrue(result);
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.Status == CNTaskStatus.DOING &amp;&amp; x.TaskId == mockTask.TaskId));
        }



        [Test]
        public async Task PauseATask_TaskNotExist_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult((CNTask)null));

            //Act
            var result = await targetService.PauseATask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }

        [Test]
        public async Task PauseATask_TaskIsDeleted_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.IsDeleted = true;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            var result = await targetService.PauseATask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }
        [Test]
        public void PauseATask_TaskStatusNotValid_ThrowsException()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.PENDING;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            Assert.ThrowsAsync&lt;TaskStatusException&gt;(async () =&gt; await targetService.PauseATask(mockTask.TaskId));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }
        [Test]
        public async Task PauseATask_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.DOING;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            await targetService.PauseATask(mockTask.TaskId);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.Status == CNTaskStatus.TODO &amp;&amp; x.TaskId == mockTask.TaskId));
        }


        [Test]
        public async Task PendingATask_TaskNotExist_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult((CNTask)null));

            //Act
            var result = await targetService.PendingATask(mockTask.TaskId,null);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }

        [Test]
        public async Task PendingATask_TaskIsDeleted_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.IsDeleted = true;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            var result = await targetService.PendingATask(mockTask.TaskId, null);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }
        [Test]
        public void PendingATask_TaskStatusNotValid_ThrowsException()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.DONE;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            Assert.ThrowsAsync&lt;TaskStatusException&gt;(async () =&gt; await targetService.PendingATask(mockTask.TaskId, null));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }
        [Test]
        public async Task PendingATask_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.DOING;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            await targetService.PendingATask(mockTask.TaskId, &quot;pending reason&quot;);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; 
                x.Status == CNTaskStatus.PENDING 
                &amp;&amp; &quot;pending reason&quot;.Equals(x.PendingReason)
                &amp;&amp; x.TaskId == mockTask.TaskId));
        }


        [Test]
        public async Task FinishATask_TaskNotExist_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult((CNTask)null));

            //Act
            var result = await targetService.FinishATask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }

        [Test]
        public async Task FinishATask_TaskIsDeleted_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.IsDeleted = true;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            var result = await targetService.FinishATask(mockTask.TaskId);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }
        [Test]
        public void FinishATask_TaskStatusNotValid_ThrowsException()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.DONE;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            Assert.ThrowsAsync&lt;TaskStatusException&gt;(async () =&gt; await targetService.FinishATask(mockTask.TaskId));

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }
        [Test]
        public async Task FinishATask_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.DOING;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            await targetService.FinishATask(mockTask.TaskId);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.Status == CNTaskStatus.DONE &amp;&amp; x.TaskId == mockTask.TaskId));
        }


        [Test]
        public async Task FailATask_TaskNotExist_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult((CNTask)null));

            //Act
            var result = await targetService.FailATask(mockTask.TaskId,null);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }


        [Test]
        public async Task FailATask_TaskAlreadyFail_UpdateReason()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.IsFail = true;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            await targetService.FailATask(mockTask.TaskId, &quot;reason&quot;);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x=&gt;x.FailReason.Equals(&quot;reason&quot;) &amp;&amp; x.TaskId == mockTask.TaskId));
        }
        [Test]
        public async Task FailATask_TaskNotAlreadyFail_UpdateBothFields()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.IsFail = false;
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            await targetService.FailATask(mockTask.TaskId, &quot;reason&quot;);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.FailReason.Equals(&quot;reason&quot;) &amp;&amp; x.IsFail &amp;&amp; x.TaskId == mockTask.TaskId));
        }


        [Test]
        public async Task SetParentTask_TaskIsNull_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockParentTask = DomainTestHelper.GetARandomTask(2);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            await targetService.SetParentTask(0, mockParentTask.TaskId,-1);

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }
        [Test]
        public async Task SetParentTask_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockParentTask = DomainTestHelper.GetARandomTask(2);
            //Assess
            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            mockTaskDataStore.GetTask(mockParentTask.TaskId).Returns(Task.FromResult(mockParentTask));
            //Act
            await targetService.SetParentTask(mockTask.TaskId, mockParentTask.TaskId,-1);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.ParentTaskID == mockParentTask.TaskId &amp;&amp; x.TaskId == mockTask.TaskId));
        }

        [Test]
        public async Task SetParentTask_SetParentTaskNull_WithNoPos()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(4);
            var mockSort = 10;
            var mockTask1 = DomainTestHelper.GetARandomTask(1);
            var mockTask2 = DomainTestHelper.GetARandomTask(2);
            var mockTask3 = DomainTestHelper.GetARandomTask(3);
            mockTask1.Sort = 1;
            mockTask2.Sort = 2;
            mockTask3.Sort = 3;
            //Assess
            mockTaskDataStore.GetAllTask().Returns(new List&lt;CNTask&gt;() { mockTask1, mockTask2, mockTask3 });
            mockTaskDataStore.GetMaxSort(0).Returns(Task.FromResult(mockSort));

            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));
            //Act
            await targetService.SetParentTask(mockTask.TaskId, 0, -1);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.ParentTaskID == 0
                                                                              &amp;&amp; x.TaskId == mockTask.TaskId
                                                                              &amp;&amp; x.Sort == mockSort+1));
        }

        [Test]
        public async Task SetParentTask_SetParentTaskNull_WithLastPos()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask1 = DomainTestHelper.GetARandomTask(1);
            var mockTask2 = DomainTestHelper.GetARandomTask(2);
            var mockTask3 = DomainTestHelper.GetARandomTask(3);
            var targetTask = DomainTestHelper.GetARandomTask(4);
            mockTask1.Sort = 1;
            mockTask2.Sort = 2;
            mockTask3.Sort = 3;
            //Assess
            mockTaskDataStore.GetAllTask().Returns(new List&lt;CNTask&gt;(){mockTask1,mockTask2,mockTask3});

            mockTaskDataStore.GetTask(targetTask.TaskId).Returns(Task.FromResult(targetTask));
            //Act
            await targetService.SetParentTask(targetTask.TaskId, 0, 2);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.ParentTaskID == 0
                                                                              &amp;&amp; x.TaskId == targetTask.TaskId
                                                                              &amp;&amp; x.Sort == mockTask3.Sort + 1));
        }

        [Test]
        public async Task SetParentTask_SetParentTaskNull_WithMiddlePos()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask1 = DomainTestHelper.GetARandomTask(1);
            var mockTask2 = DomainTestHelper.GetARandomTask(2);
            var mockTask3 = DomainTestHelper.GetARandomTask(3);
            var targetTask = DomainTestHelper.GetARandomTask(4);
            mockTask1.Sort = 1;
            mockTask2.Sort = 2;
            mockTask3.Sort = 3;
            //Assess
            mockTaskDataStore.GetAllTask().Returns(new List&lt;CNTask&gt;() { mockTask1, mockTask2, mockTask3 });

            mockTaskDataStore.GetTask(targetTask.TaskId).Returns(Task.FromResult(targetTask));
            //Act
            await targetService.SetParentTask(targetTask.TaskId, 0, 1);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.ParentTaskID == 0
                                                                              &amp;&amp; x.TaskId == targetTask.TaskId
                                                                              &amp;&amp; x.Sort == mockTask2.Sort + 1));
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.TaskId == mockTask3.TaskId
                                                                              &amp;&amp; x.Sort == mockTask2.Sort + 2));
        }

        [Test]
        public async Task SetParentTask_SetParentTaskNotNull_WithNoPos()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockParent = DomainTestHelper.GetARandomTask(10);
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockSort = 10;
            //Assess
            mockTaskDataStore.GetMaxSort(mockParent.TaskId).Returns(Task.FromResult(mockSort));

            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));
            mockTaskDataStore.GetTask(mockParent.TaskId).Returns(Task.FromResult(mockParent));
            //Act
            await targetService.SetParentTask(mockTask.TaskId, mockParent.TaskId, -1);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.ParentTaskID == mockParent.TaskId
                                                                              &amp;&amp; x.TaskId == mockTask.TaskId
                                                                              &amp;&amp; x.Sort == mockSort + 1));
        }

        [Test]
        public async Task SetParentTask_SetParentTaskNotNull_WithLastPos()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockParent = DomainTestHelper.GetARandomTask(10);
            var mockTask1 = DomainTestHelper.GetARandomTask(1);
            var mockTask2 = DomainTestHelper.GetARandomTask(2);
            var mockTask3 = DomainTestHelper.GetARandomTask(3);
            var targetTask = DomainTestHelper.GetARandomTask(4);
            mockTask1.Sort = 1;
            mockTask2.Sort = 2;
            mockTask3.Sort = 3;
            mockParent.ChildTasks.Add(mockTask1);
            mockParent.ChildTasks.Add(mockTask2);
            mockParent.ChildTasks.Add(mockTask3);
            //Assess
            mockTaskDataStore.GetTask(targetTask.TaskId).Returns(Task.FromResult(targetTask));
            mockTaskDataStore.GetTask(mockParent.TaskId).Returns(Task.FromResult(mockParent));

            //Act
            await targetService.SetParentTask(targetTask.TaskId, mockParent.TaskId, 5);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.ParentTaskID == mockParent.TaskId
                                                                              &amp;&amp; x.TaskId == targetTask.TaskId
                                                                              &amp;&amp; x.Sort == mockTask3.Sort + 1));
        }

        [Test]
        public async Task SetParentTask_SetParentTaskNotNull_WithMiddlePos()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockParent = DomainTestHelper.GetARandomTask(10);
            var mockTask1 = DomainTestHelper.GetARandomTask(1);
            var mockTask2 = DomainTestHelper.GetARandomTask(2);
            var mockTask3 = DomainTestHelper.GetARandomTask(3);
            var targetTask = DomainTestHelper.GetARandomTask(4);
            mockTask1.Sort = 1;
            mockTask2.Sort = 2;
            mockTask3.Sort = 3;
            mockParent.ChildTasks.Add(mockTask1);
            mockParent.ChildTasks.Add(mockTask2);
            mockParent.ChildTasks.Add(mockTask3);
            //Assess
            mockTaskDataStore.GetTask(targetTask.TaskId).Returns(Task.FromResult(targetTask));
            mockTaskDataStore.GetTask(mockParent.TaskId).Returns(Task.FromResult(mockParent));

            //Act
            await targetService.SetParentTask(targetTask.TaskId, mockParent.TaskId, 1);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.ParentTaskID == mockParent.TaskId
                                                                              &amp;&amp; x.TaskId == targetTask.TaskId
                                                                              &amp;&amp; x.Sort == mockTask2.Sort + 1));
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt; x.TaskId == mockTask3.TaskId
                                                                              &amp;&amp; x.Sort == mockTask2.Sort + 2));
        }
        [Test]
        public async Task AddPreTask_TargetTaskIsNull_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.DONE;
            //Assess

            //Act
            var result = await targetService.AddPreTask(null, null);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }


        [Test]
        public async Task AddPreTask_PreTaskExists_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockPreTask = DomainTestHelper.GetARandomTask(2);
            mockTask.PreTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = mockPreTask,
                PreTaskId = mockPreTask.TaskId,
                SufTask = mockTask,
                SufTaskId = mockTask.TaskId
            });
            //Assess

            //Act
            var result = await targetService.AddPreTask(mockTask, mockPreTask);

            //Assert
            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }


        [Test]
        public async Task AddPreTask_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.TODO;
            var mockPreTask = DomainTestHelper.GetARandomTask(2);
            mockPreTask.Status = CNTaskStatus.TODO;
            mockPreTask.Status = CNTaskStatus.TODO;
            //Assess

            //Act
            await targetService.AddPreTask(mockTask, mockPreTask);

            //Assert
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x=&gt;
                x.TaskId == mockTask.TaskId
                &amp;&amp; x.PreTaskConnectors!=null
                &amp;&amp; x.PreTaskConnectors.Count&gt;0
                &amp;&amp; x.PreTaskConnectors.Any(y=&gt;y.PreTask.TaskId == mockPreTask.TaskId)));
        }


        [Test]
        public async Task DelPreTask_TargetTaskIsNull_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.DONE;
            //Assess
            //Act
            var result = await targetService.DelPreTask(null, null);

            //Assert
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }


        [Test]
        public async Task DelPreTask_Success()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            mockTask.Status = CNTaskStatus.PENDING;
            mockTask.PendingReason = CNConstants.PENDINGREASON_PreTaskNotComplete;
            var mockPreTask = DomainTestHelper.GetARandomTask(2);
            var mockPreTaskDone = DomainTestHelper.GetARandomTask(3);
            mockPreTaskDone.Status = CNTaskStatus.DONE;
            mockPreTask.Status = CNTaskStatus.TODO;
            mockTask.PreTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = mockPreTask,
                PreTaskId = mockPreTask.TaskId,
                SufTask = mockTask,
                SufTaskId = mockTask.TaskId
            });
            mockTask.PreTaskConnectors.Add(new CNTaskConnector()
            {
                PreTask = mockPreTaskDone,
                PreTaskId = mockPreTaskDone.TaskId,
                SufTask = mockTask,
                SufTaskId = mockTask.TaskId
            });
            //Assess
            mockTaskDataStore.RemoveTaskConnector(Arg.Is&lt;CNTaskConnector&gt;(x =&gt;
                x.PreTaskId == mockPreTask.TaskId &amp;&amp; x.SufTaskId == mockTask.TaskId));

            //Act
            await targetService.DelPreTask(mockTask, mockPreTask);

            //Assert
             mockTaskDataStore.Received().RemoveTaskConnector(Arg.Is&lt;CNTaskConnector&gt;(x =&gt;
                x.PreTaskId == mockPreTask.TaskId &amp;&amp; x.SufTaskId == mockTask.TaskId));
             mockTaskDataStore.Received().UpdateTask(Arg.Is&lt;CNTask&gt;(x =&gt;
                x.TaskId == mockTask.TaskId
                &amp;&amp; x.PreTaskConnectors != null
                &amp;&amp; x.PreTaskConnectors.Count &gt; 0
                &amp;&amp; x.PreTaskConnectors.Any(y =&gt; y.PreTask.TaskId == mockPreTask.TaskId)));
        }


        [Test]
        public async Task DelPreTask_PreTaskNotExist_ReturnFalse()
        {
            var mockTaskDataStore = _kernel.Get&lt;ITaskDataStore&gt;();
            var targetService = _kernel.Get&lt;ITaskService&gt;();
            var mockTask = DomainTestHelper.GetARandomTask(1);
            var mockPreTask = DomainTestHelper.GetARandomTask(2);
            mockPreTask.Status = CNTaskStatus.TODO;
            //Assess
            //            mockTaskDataStore.GetTask(mockTask.TaskId).Returns(Task.FromResult(mockTask));

            //Act
            var result = await targetService.DelPreTask(mockTask, mockPreTask);

            //Assert

            Assert.IsFalse(result);
             mockTaskDataStore.DidNotReceiveWithAnyArgs().UpdateTask(mockTask);
        }


    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[21,9,21,10,1],[22,13,22,67,1],[23,13,23,77,1],[24,13,24,61,1],[25,13,25,36,1],[28,13,28,64,1],[29,13,30,50,1],[31,13,36,28,1],[37,13,37,93,1],[40,13,40,81,1],[43,13,45,80,1],[46,13,48,85,1],[49,9,49,10,1],[53,9,53,10,1],[54,13,54,67,1],[55,13,55,77,1],[56,13,56,61,1],[57,13,57,36,1],[60,13,60,64,1],[61,13,61,104,1],[62,13,67,28,1],[68,13,68,93,1],[71,13,71,81,1],[74,13,76,80,1],[77,13,79,85,1],[80,9,80,10,1],[84,9,84,10,1],[85,13,85,67,1],[86,13,86,77,1],[87,13,87,61,1],[90,13,90,82,1],[93,13,93,103,1],[96,13,96,35,1],[97,13,97,89,1],[98,9,98,10,1],[102,9,102,10,1],[103,13,103,67,1],[104,13,104,77,1],[105,13,105,61,1],[106,13,106,36,1],[109,13,109,64,1],[110,13,115,28,1],[116,13,116,93,1],[119,13,120,17,1],[120,17,120,102,1],[120,102,120,104,1],[119,13,120,104,1],[123,14,123,90,1],[124,9,124,10,1],[128,9,128,10,1],[129,13,129,67,1],[130,13,130,77,1],[131,13,131,61,1],[134,13,134,64,1],[136,13,136,96,1],[139,13,139,82,1],[142,13,142,38,1],[143,13,143,45,1],[144,13,144,93,1],[145,9,145,10,1],[148,9,148,10,1],[149,13,149,67,1],[150,13,150,77,1],[151,13,151,61,1],[154,13,154,64,1],[156,13,156,93,1],[159,13,159,69,1],[162,13,162,92,1],[163,9,163,10,1],[166,9,166,10,1],[167,13,167,67,1],[168,13,168,77,1],[169,13,169,61,1],[170,13,170,36,1],[173,13,173,64,1],[175,13,175,96,1],[178,13,178,77,1],[181,14,182,40,1],[183,14,183,89,1],[184,9,184,10,1],[187,9,187,10,1],[188,13,188,67,1],[189,13,189,77,1],[190,13,190,61,1],[191,13,191,36,1],[194,13,194,64,1],[195,13,195,69,1],[196,13,196,67,1],[197,13,197,54,1],[198,13,204,16,1],[205,13,205,51,1],[206,13,206,48,1],[208,13,208,93,1],[211,13,211,77,1],[214,14,215,90,1],[216,14,216,88,1],[217,9,217,10,1],[220,9,220,10,1],[221,13,221,67,1],[222,13,222,77,1],[223,13,223,61,1],[224,13,224,36,1],[227,13,227,64,1],[228,13,228,51,1],[230,13,230,49,1],[231,13,236,19,1],[237,13,241,28,1],[242,13,242,93,1],[243,13,244,59,1],[246,13,246,66,1],[249,14,250,95,1],[251,14,252,95,1],[253,14,253,80,1],[254,9,254,10,1],[258,9,258,10,1],[259,13,259,67,1],[260,13,260,77,1],[261,13,261,61,1],[262,13,262,36,1],[265,13,265,64,1],[266,13,266,51,1],[268,13,268,69,1],[269,13,274,19,1],[275,13,280,28,1],[281,13,281,93,1],[282,13,283,59,1],[285,13,285,66,1],[288,14,288,96,1],[289,14,290,104,1],[291,14,291,80,1],[292,9,292,10,1],[296,9,296,10,1],[297,13,297,67,1],[298,13,298,77,1],[299,13,299,61,1],[300,13,300,36,1],[303,13,303,64,1],[304,13,304,51,1],[306,13,306,69,1],[307,13,312,19,1],[313,13,318,28,1],[319,13,319,93,1],[320,13,321,63,1],[323,13,323,79,1],[326,13,326,36,1],[327,14,327,96,1],[328,14,328,94,1],[329,14,329,96,1],[330,9,330,10,1],[334,9,334,10,1],[335,13,335,67,1],[336,13,336,77,1],[337,13,337,61,1],[338,13,338,36,1],[341,13,341,64,1],[342,13,342,51,1],[344,13,344,69,1],[345,13,350,19,1],[351,13,356,28,1],[357,13,357,93,1],[358,13,359,59,1],[361,13,361,66,1],[364,14,364,94,1],[365,14,366,106,1],[367,14,367,80,1],[368,9,368,10,1],[372,9,372,10,1],[373,13,373,67,1],[374,13,374,77,1],[375,13,375,61,1],[376,13,376,36,1],[379,13,379,64,1],[380,13,380,69,1],[381,13,381,67,1],[382,13,382,54,1],[383,13,389,16,1],[390,13,390,51,1],[392,13,392,69,1],[393,13,394,113,1],[395,13,400,28,1],[401,13,401,93,1],[402,13,403,59,1],[405,13,405,81,1],[408,14,409,104,1],[410,13,410,58,1],[411,14,411,80,1],[412,9,412,10,1],[416,9,416,10,1],[417,13,417,67,1],[418,13,418,77,1],[419,13,419,61,1],[420,13,420,36,1],[423,13,423,64,1],[424,13,424,69,1],[425,13,425,67,1],[426,13,426,54,1],[427,13,433,16,1],[434,13,434,51,1],[436,13,436,69,1],[437,13,438,115,1],[439,13,444,28,1],[445,13,445,93,1],[446,13,447,59,1],[449,13,449,81,1],[452,14,453,64,1],[454,13,454,58,1],[455,14,455,96,1],[456,9,456,10,1],[460,9,460,10,1],[461,13,461,67,1],[462,13,462,77,1],[463,13,463,61,1],[464,13,464,36,1],[467,13,467,64,1],[468,13,468,69,1],[469,13,469,67,1],[470,13,470,54,1],[471,13,477,16,1],[478,13,478,51,1],[480,13,480,69,1],[481,13,482,131,1],[483,13,488,28,1],[489,13,489,93,1],[490,13,491,59,1],[493,13,493,81,1],[496,14,497,64,1],[498,13,498,58,1],[499,14,499,96,1],[500,9,500,10,1],[503,9,503,10,1],[504,13,504,67,1],[505,13,505,77,1],[506,13,506,61,1],[507,13,507,36,1],[510,13,510,64,1],[511,13,511,51,1],[513,13,513,69,1],[514,13,515,115,1],[516,13,521,28,1],[522,13,522,93,1],[523,13,524,59,1],[526,13,526,81,1],[529,14,530,104,1],[531,13,531,58,1],[532,14,532,80,1],[533,9,533,10,1],[537,9,537,10,1],[538,13,538,67,1],[539,13,539,61,1],[543,13,543,62,1],[546,13,546,36,1],[547,14,547,76,1],[548,9,548,10,1],[551,9,551,10,1],[552,13,552,67,1],[553,13,553,61,1],[554,13,554,59,1],[555,13,555,41,1],[558,13,558,60,1],[558,60,558,95,1],[558,95,558,97,1],[558,13,558,97,1],[561,14,561,76,1],[562,9,562,10,1],[565,9,565,10,1],[566,13,566,67,1],[567,13,567,61,1],[568,13,568,57,1],[569,13,569,63,1],[572,13,572,64,1],[575,13,575,66,1],[578,13,578,35,1],[579,14,579,109,1],[580,9,580,10,1],[583,9,583,10,1],[584,13,584,67,1],[585,13,585,61,1],[589,13,589,47,1],[592,13,592,61,1],[593,9,593,10,1],[596,9,596,10,1],[597,13,597,67,1],[598,13,598,61,1],[602,13,602,48,1],[605,13,605,59,1],[606,9,606,10,1],[609,9,609,10,1],[610,13,610,67,1],[611,13,611,61,1],[612,13,612,62,1],[615,13,615,55,1],[618,14,618,106,1],[619,9,619,10,1],[623,9,623,10,1],[624,13,624,67,1],[625,13,625,61,1],[626,13,626,62,1],[627,13,627,45,1],[631,13,631,60,1],[631,60,631,101,1],[631,101,631,103,1],[631,13,631,103,1],[633,14,633,77,1],[634,9,634,10,1],[638,9,638,10,1],[639,13,639,67,1],[640,13,640,61,1],[641,13,641,63,1],[643,13,643,95,1],[646,13,646,74,1],[649,13,649,36,1],[650,14,650,80,1],[651,9,651,10,1],[654,9,654,10,1],[655,13,655,67,1],[656,13,656,61,1],[657,13,657,63,1],[658,13,658,39,1],[660,13,660,91,1],[663,13,663,74,1],[666,13,666,35,1],[667,14,667,80,1],[668,9,668,10,1],[671,9,671,10,1],[672,13,672,67,1],[673,13,673,61,1],[674,13,674,63,1],[675,13,675,68,1],[676,13,676,52,1],[677,13,677,40,1],[679,13,679,91,1],[682,13,682,71,1],[682,71,682,118,1],[682,118,682,120,1],[682,13,682,120,1],[685,14,685,80,1],[686,9,686,10,1],[689,9,689,10,1],[690,13,690,67,1],[691,13,691,61,1],[692,13,692,63,1],[693,13,693,66,1],[694,13,698,16,1],[699,13,699,40,1],[701,13,701,91,1],[704,13,704,70,1],[704,70,704,117,1],[704,117,704,119,1],[704,13,704,119,1],[707,14,707,80,1],[708,9,708,10,1],[712,9,712,10,1],[713,13,713,67,1],[714,13,714,61,1],[715,13,715,63,1],[716,13,716,68,1],[717,13,717,52,1],[718,13,718,66,1],[719,13,723,16,1],[724,13,724,40,1],[726,13,726,91,1],[729,13,729,66,1],[732,14,732,121,1],[733,9,733,10,1],[739,9,739,10,1],[740,13,740,67,1],[741,13,741,61,1],[742,13,742,63,1],[744,13,744,95,1],[747,13,747,76,1],[750,13,750,36,1],[751,14,751,80,1],[752,9,752,10,1],[755,9,755,10,1],[756,13,756,67,1],[757,13,757,61,1],[758,13,758,63,1],[759,13,759,40,1],[761,13,761,91,1],[764,13,764,76,1],[767,13,767,35,1],[768,14,768,80,1],[769,9,769,10,1],[772,9,772,10,1],[773,13,773,67,1],[774,13,774,61,1],[775,13,775,63,1],[776,13,776,68,1],[777,13,777,52,1],[778,13,778,66,1],[779,13,783,16,1],[784,13,784,39,1],[786,13,786,91,1],[789,13,789,63,1],[792,14,792,122,1],[793,9,793,10,1],[799,9,799,10,1],[800,13,800,67,1],[801,13,801,61,1],[802,13,802,63,1],[804,13,804,95,1],[807,13,807,75,1],[810,13,810,36,1],[811,14,811,80,1],[812,9,812,10,1],[815,9,815,10,1],[816,13,816,67,1],[817,13,817,61,1],[818,13,818,63,1],[819,13,819,40,1],[821,13,821,91,1],[824,13,824,75,1],[827,13,827,36,1],[828,14,828,80,1],[829,9,829,10,1],[832,9,832,10,1],[833,13,833,67,1],[834,13,834,61,1],[835,13,835,63,1],[836,13,836,68,1],[837,13,837,52,1],[838,13,838,39,1],[840,13,840,91,1],[843,13,843,72,1],[843,72,843,120,1],[843,120,843,122,1],[843,13,843,122,1],[846,14,846,80,1],[847,9,847,10,1],[850,9,850,10,1],[851,13,851,67,1],[852,13,852,61,1],[853,13,853,63,1],[854,13,854,66,1],[855,13,855,39,1],[856,13,860,16,1],[862,13,862,91,1],[865,13,865,70,1],[865,70,865,118,1],[865,118,865,120,1],[865,13,865,120,1],[868,14,868,80,1],[869,9,869,10,1],[873,9,873,10,1],[874,13,874,67,1],[875,13,875,61,1],[876,13,876,63,1],[877,13,877,68,1],[878,13,878,52,1],[879,13,879,39,1],[880,13,880,66,1],[881,13,885,16,1],[887,13,887,91,1],[890,13,890,68,1],[893,14,893,104,1],[894,9,894,10,1],[898,9,898,10,1],[899,13,899,67,1],[900,13,900,61,1],[901,13,901,63,1],[903,13,903,95,1],[906,13,906,74,1],[909,13,909,36,1],[910,14,910,80,1],[911,9,911,10,1],[915,9,915,10,1],[916,13,916,67,1],[917,13,917,61,1],[918,13,918,63,1],[919,13,919,39,1],[921,13,921,91,1],[924,13,924,74,1],[927,13,927,36,1],[928,14,928,80,1],[929,9,929,10,1],[932,9,932,10,1],[933,13,933,67,1],[934,13,934,61,1],[935,13,935,63,1],[936,13,936,50,1],[938,13,938,91,1],[941,13,941,65,1],[941,65,941,112,1],[941,112,941,114,1],[941,13,941,114,1],[944,14,944,80,1],[945,9,945,10,1],[948,9,948,10,1],[949,13,949,67,1],[950,13,950,61,1],[951,13,951,57,1],[952,13,952,63,1],[953,13,953,49,1],[955,13,955,91,1],[956,13,956,64,1],[958,13,958,74,1],[961,13,961,35,1],[962,14,962,138,1],[963,9,963,10,1],[969,9,969,10,1],[970,13,970,67,1],[971,13,971,61,1],[972,13,972,63,1],[974,13,974,95,1],[977,13,977,74,1],[980,13,980,36,1],[981,14,981,80,1],[982,9,982,10,1],[986,9,986,10,1],[987,13,987,67,1],[988,13,988,61,1],[989,13,989,63,1],[990,13,990,39,1],[992,13,992,91,1],[995,13,995,74,1],[998,13,998,36,1],[999,14,999,80,1],[1000,9,1000,10,1],[1003,9,1003,10,1],[1004,13,1004,67,1],[1005,13,1005,61,1],[1006,13,1006,63,1],[1007,13,1007,52,1],[1009,13,1009,91,1],[1012,13,1012,65,1],[1012,65,1012,112,1],[1012,112,1012,114,1],[1012,13,1012,114,1],[1015,14,1015,80,1],[1016,9,1016,10,1],[1019,9,1019,10,1],[1020,13,1020,67,1],[1021,13,1021,61,1],[1022,13,1022,63,1],[1023,13,1023,50,1],[1025,13,1025,91,1],[1028,13,1028,61,1],[1031,14,1031,137,1],[1032,9,1032,10,1],[1037,9,1037,10,1],[1038,13,1038,67,1],[1039,13,1039,61,1],[1040,13,1040,63,1],[1042,13,1042,95,1],[1045,13,1045,81,1],[1048,13,1048,36,1],[1049,14,1049,80,1],[1050,9,1050,10,1],[1054,9,1054,10,1],[1055,13,1055,67,1],[1056,13,1056,61,1],[1057,13,1057,63,1],[1058,13,1058,39,1],[1060,13,1060,91,1],[1063,13,1063,82,1],[1066,13,1066,36,1],[1067,14,1067,80,1],[1068,9,1068,10,1],[1071,9,1071,10,1],[1072,13,1072,67,1],[1073,13,1073,61,1],[1074,13,1074,63,1],[1075,13,1075,49,1],[1077,13,1077,91,1],[1080,13,1080,65,1],[1080,65,1080,120,1],[1080,120,1080,122,1],[1080,13,1080,122,1],[1083,14,1083,80,1],[1084,9,1084,10,1],[1087,9,1087,10,1],[1088,13,1088,67,1],[1089,13,1089,61,1],[1090,13,1090,63,1],[1091,13,1091,50,1],[1093,13,1093,91,1],[1096,13,1096,81,1],[1099,14,1102,50,1],[1103,9,1103,10,1],[1108,9,1108,10,1],[1109,13,1109,67,1],[1110,13,1110,61,1],[1111,13,1111,63,1],[1113,13,1113,95,1],[1116,13,1116,75,1],[1119,13,1119,36,1],[1120,14,1120,80,1],[1121,9,1121,10,1],[1125,9,1125,10,1],[1126,13,1126,67,1],[1127,13,1127,61,1],[1128,13,1128,63,1],[1129,13,1129,39,1],[1131,13,1131,91,1],[1134,13,1134,75,1],[1137,13,1137,36,1],[1138,14,1138,80,1],[1139,9,1139,10,1],[1142,9,1142,10,1],[1143,13,1143,67,1],[1144,13,1144,61,1],[1145,13,1145,63,1],[1146,13,1146,49,1],[1148,13,1148,91,1],[1151,13,1151,65,1],[1151,65,1151,113,1],[1151,113,1151,115,1],[1151,13,1151,115,1],[1154,14,1154,80,1],[1155,9,1155,10,1],[1158,9,1158,10,1],[1159,13,1159,67,1],[1160,13,1160,61,1],[1161,13,1161,63,1],[1162,13,1162,50,1],[1164,13,1164,91,1],[1167,13,1167,62,1],[1170,14,1170,137,1],[1171,9,1171,10,1],[1176,9,1176,10,1],[1177,13,1177,67,1],[1178,13,1178,61,1],[1179,13,1179,63,1],[1181,13,1181,95,1],[1184,13,1184,78,1],[1187,13,1187,36,1],[1188,14,1188,80,1],[1189,9,1189,10,1],[1194,9,1194,10,1],[1195,13,1195,67,1],[1196,13,1196,61,1],[1197,13,1197,63,1],[1198,13,1198,36,1],[1200,13,1200,91,1],[1203,13,1203,70,1],[1206,14,1206,135,1],[1207,9,1207,10,1],[1210,9,1210,10,1],[1211,13,1211,67,1],[1212,13,1212,61,1],[1213,13,1213,63,1],[1214,13,1214,37,1],[1216,13,1216,91,1],[1219,13,1219,70,1],[1222,14,1222,149,1],[1223,9,1223,10,1],[1228,9,1228,10,1],[1229,13,1229,67,1],[1230,13,1230,61,1],[1231,13,1231,63,1],[1232,13,1232,69,1],[1234,13,1234,91,1],[1237,13,1237,76,1],[1240,14,1240,80,1],[1241,9,1241,10,1],[1244,9,1244,10,1],[1245,13,1245,67,1],[1246,13,1246,61,1],[1247,13,1247,63,1],[1248,13,1248,69,1],[1250,13,1250,91,1],[1252,13,1252,103,1],[1254,13,1254,90,1],[1257,14,1257,147,1],[1258,9,1258,10,1],[1262,9,1262,10,1],[1263,13,1263,67,1],[1264,13,1264,61,1],[1265,13,1265,63,1],[1266,13,1266,31,1],[1267,13,1267,64,1],[1268,13,1268,64,1],[1269,13,1269,64,1],[1270,13,1270,32,1],[1271,13,1271,32,1],[1272,13,1272,32,1],[1274,13,1274,108,1],[1275,13,1275,80,1],[1277,13,1277,91,1],[1279,13,1279,71,1],[1282,14,1284,105,1],[1285,9,1285,10,1],[1289,9,1289,10,1],[1290,13,1290,67,1],[1291,13,1291,61,1],[1292,13,1292,64,1],[1293,13,1293,64,1],[1294,13,1294,64,1],[1295,13,1295,65,1],[1296,13,1296,32,1],[1297,13,1297,32,1],[1298,13,1298,32,1],[1300,13,1300,103,1],[1302,13,1302,95,1],[1304,13,1304,72,1],[1307,14,1309,113,1],[1310,9,1310,10,1],[1314,9,1314,10,1],[1315,13,1315,67,1],[1316,13,1316,61,1],[1317,13,1317,64,1],[1318,13,1318,64,1],[1319,13,1319,64,1],[1320,13,1320,65,1],[1321,13,1321,32,1],[1322,13,1322,32,1],[1323,13,1323,32,1],[1325,13,1325,108,1],[1327,13,1327,95,1],[1329,13,1329,72,1],[1332,14,1334,113,1],[1335,14,1336,113,1],[1337,9,1337,10,1],[1341,9,1341,10,1],[1342,13,1342,67,1],[1343,13,1343,61,1],[1344,13,1344,66,1],[1345,13,1345,63,1],[1346,13,1346,31,1],[1348,13,1348,96,1],[1350,13,1350,91,1],[1351,13,1351,95,1],[1353,13,1353,87,1],[1356,14,1358,107,1],[1359,9,1359,10,1],[1363,9,1363,10,1],[1364,13,1364,67,1],[1365,13,1365,61,1],[1366,13,1366,66,1],[1367,13,1367,64,1],[1368,13,1368,64,1],[1369,13,1369,64,1],[1370,13,1370,65,1],[1371,13,1371,32,1],[1372,13,1372,32,1],[1373,13,1373,32,1],[1374,13,1374,50,1],[1375,13,1375,50,1],[1376,13,1376,50,1],[1378,13,1378,95,1],[1379,13,1379,95,1],[1382,13,1382,88,1],[1385,14,1387,113,1],[1388,9,1388,10,1],[1392,9,1392,10,1],[1393,13,1393,67,1],[1394,13,1394,61,1],[1395,13,1395,66,1],[1396,13,1396,64,1],[1397,13,1397,64,1],[1398,13,1398,64,1],[1399,13,1399,65,1],[1400,13,1400,32,1],[1401,13,1401,32,1],[1402,13,1402,32,1],[1403,13,1403,50,1],[1404,13,1404,50,1],[1405,13,1405,50,1],[1407,13,1407,95,1],[1408,13,1408,95,1],[1411,13,1411,88,1],[1414,14,1416,113,1],[1417,14,1418,113,1],[1419,9,1419,10,1],[1422,9,1422,10,1],[1423,13,1423,67,1],[1424,13,1424,61,1],[1425,13,1425,63,1],[1426,13,1426,49,1],[1430,13,1430,69,1],[1433,13,1433,36,1],[1434,14,1434,80,1],[1435,9,1435,10,1],[1440,9,1440,10,1],[1441,13,1441,67,1],[1442,13,1442,61,1],[1443,13,1443,63,1],[1444,13,1444,66,1],[1445,13,1451,16,1],[1455,13,1455,80,1],[1458,13,1458,36,1],[1459,14,1459,80,1],[1460,9,1460,10,1],[1465,9,1465,10,1],[1466,13,1466,67,1],[1467,13,1467,61,1],[1468,13,1468,63,1],[1469,13,1469,49,1],[1470,13,1470,66,1],[1471,13,1471,52,1],[1472,13,1472,52,1],[1476,13,1476,67,1],[1479,14,1483,89,1],[1484,9,1484,10,1],[1489,9,1489,10,1],[1490,13,1490,67,1],[1491,13,1491,61,1],[1492,13,1492,63,1],[1493,13,1493,49,1],[1496,13,1496,69,1],[1499,14,1499,80,1],[1500,9,1500,10,1],[1505,9,1505,10,1],[1506,13,1506,67,1],[1507,13,1507,61,1],[1508,13,1508,63,1],[1509,13,1509,52,1],[1510,13,1510,83,1],[1511,13,1511,66,1],[1512,13,1512,70,1],[1513,13,1513,56,1],[1514,13,1514,52,1],[1515,13,1521,16,1],[1522,13,1528,16,1],[1530,13,1531,87,1],[1534,13,1534,67,1],[1537,14,1538,87,1],[1539,14,1543,91,1],[1544,9,1544,10,1],[1549,9,1549,10,1],[1550,13,1550,67,1],[1551,13,1551,61,1],[1552,13,1552,63,1],[1553,13,1553,66,1],[1554,13,1554,52,1],[1559,13,1559,80,1],[1563,13,1563,36,1],[1564,14,1564,80,1],[1565,9,1565,10,1]]);
    </script>
  </body>
</html>