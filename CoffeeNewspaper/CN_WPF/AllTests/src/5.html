<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>e:\githubproject\coffeenewspaper\coffeenewspaper\cn_cli\command\savetaskcommand.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Drawing;
using System.Threading.Tasks;
using CN_Core;
using CN_Core.Interfaces.Service;
using Console = Colorful.Console;

namespace CoffeeNewspaper_CLI
{
    public class SaveTaskCommand : BaseCommand
    {
        public SaveTaskCommand(BaseState state) : base(state)
        {
            Name = &quot;save&quot;;
        }

        public override async Task&lt;BaseState&gt; Excute(ArgumentParser input)
        {
            if (State != null &amp;&amp; State.StateObj is CNTask task)
            {
                if (!ValidInputComplete(task,enableConsoleOutput:true))
                {
                    Console.WriteLine(&quot;edit not complete&quot;, Color.Red);
                    return State;
                }

                if (task.TaskId == 0)
                {
                    task.CreateTime = DateTime.Now;
                    if (await IoC.Get&lt;ITaskService&gt;().CreateATask(task) !=null)
                    {
                        Console.WriteLine(&quot;task create success!&quot;, Color.Green);
                    }
                    else
                    {
                        Console.WriteLine(&quot;task create fail!&quot;, Color.Red);
                    }
                }
                else
                {
                    if (await IoC.Get&lt;ITaskService&gt;().EditATask(task))
                    {
                        Console.WriteLine(&quot;task edit success!&quot;, Color.Green);
                    }
                    else
                    {
                        Console.WriteLine(&quot;task edit fail!&quot;, Color.Red);
                    }
                }

            }
            else
            {
                Console.WriteLine(&quot;wrong parameter&quot;,Color.Red);
            }

            Console.WriteLine();
            return new StartState();
        }

        public static bool ValidInputComplete(CNTask task,bool enableConsoleOutput = false)
        {
            bool result = true;
            if (string.IsNullOrEmpty(task.Content))
            {
                if(enableConsoleOutput)
                    Console.WriteLine(&quot;Content should not be empty! &quot;,Color.Yellow);
                result = false;
            }

            if (task.Priority == 0)
            {
                if (enableConsoleOutput)
                    Console.WriteLine(&quot;Priority should not be empty! &quot;, Color.Yellow);
                result = false;
            }
            if (task.Urgency == 0)
            {
                if (enableConsoleOutput)
                    Console.WriteLine(&quot;Urgency should not be empty! &quot;, Color.Yellow);
                result = false;
            }
            return result;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[12,51,12,62,0],[13,9,13,10,0],[14,13,14,27,0],[15,9,15,10,0],[18,9,18,10,0],[19,13,19,64,0],[20,13,20,14,0],[21,17,21,72,0],[22,17,22,18,0],[23,21,23,71,0],[24,21,24,34,0],[27,17,27,38,0],[28,17,28,18,0],[29,21,29,52,0],[30,21,30,80,0],[31,21,31,22,0],[32,25,32,80,0],[33,21,33,22,0],[35,21,35,22,0],[36,25,36,75,0],[37,21,37,22,0],[38,17,38,18,0],[40,17,40,18,0],[41,21,41,71,0],[42,21,42,22,0],[43,25,43,78,0],[44,21,44,22,0],[46,21,46,22,0],[47,25,47,73,0],[48,21,48,22,0],[49,17,49,18,0],[51,13,51,14,0],[53,13,53,14,0],[54,17,54,64,0],[55,13,55,14,0],[57,13,57,33,0],[58,13,58,37,0],[59,9,59,10,0],[62,9,62,10,0],[63,13,63,32,0],[64,13,64,52,0],[65,13,65,14,0],[66,17,66,40,0],[67,21,67,85,0],[68,17,68,32,0],[69,13,69,14,0],[71,13,71,36,0],[72,13,72,14,0],[73,17,73,41,0],[74,21,74,87,0],[75,17,75,32,0],[76,13,76,14,0],[77,13,77,35,0],[78,13,78,14,0],[79,17,79,41,0],[80,21,80,86,0],[81,17,81,32,0],[82,13,82,14,0],[83,13,83,27,0],[84,9,84,10,0]]);
    </script>
  </body>
</html>