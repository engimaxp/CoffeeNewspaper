<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>e:\githubproject\coffeenewspaper\coffeenewspaper\cn_wpf\attachedproperties\monitorhoverproperty.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using CN_Presentation.ViewModel.Controls;

namespace CN_WPF
{
    public class MonitorHoverProperty:BaseAttachedProperty&lt;MonitorHoverProperty,bool&gt;
    {
        /// &lt;summary&gt;
        /// When value changed to true bind the proper event
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        public override void OnValueChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
        {
            if (!(sender is ItemsControl grid)) return;


            if ((bool)e.NewValue)
            {
                grid.MouseLeave += MouseLeaveGrid;
                // Wait for panel to load
                void OnLoaded(object s, RoutedEventArgs ee)
                {
                    // Unhook
                    grid.Loaded -= OnLoaded;

                    // Loop each child
                    for (int i = 0; i &lt; grid.Items.Count; i++)
                    {
                        UIElement uiElement = (UIElement) grid.ItemContainerGenerator.ContainerFromIndex(i);
                        uiElement.MouseEnter += MouseEnterButton;
                    }
                }

                // Hook into the Loaded event
                grid.Loaded += OnLoaded;

            }
        }

        /// &lt;summary&gt;
        /// When mouse enter a button,HighLight it and those whose id is lesser,hollow the others
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;mouseEventArgs&quot;&gt;&lt;/param&gt;
        private void MouseEnterButton(object sender, MouseEventArgs mouseEventArgs)
        {
            if (!(((ContentPresenter) sender).DataContext is RatingIconButtonViewModel currentHovered)) return;
            currentHovered.ParentModel.SetChildrensSolidStatus(currentHovered.CurrentPosition);
        }

        /// &lt;summary&gt;
        /// When mouse leave the hole parent grid,make it use viewmodel&#39;s val to display highlight
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        private static void MouseLeaveGrid(object sender, RoutedEventArgs e)
        {
            if (!(sender is ItemsControl grid)) return;
            if (!(grid.DataContext is RatingViewModel ratingModel)) return;
            ratingModel.SetChildrensSolidStatus(ratingModel.SelectedValue-1);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,9,16,10,0],[17,13,17,48,0],[17,49,17,56,0],[20,13,20,34,0],[21,13,21,14,0],[22,17,22,51,0],[25,17,25,18,0],[27,21,27,45,0],[30,26,30,35,0],[30,37,30,57,0],[30,59,30,62,0],[31,21,31,22,0],[32,25,32,109,0],[33,25,33,66,0],[34,21,34,22,0],[35,17,35,18,0],[38,17,38,41,0],[40,13,40,14,0],[41,9,41,10,0],[49,9,49,10,0],[50,13,50,104,0],[50,105,50,112,0],[51,13,51,96,0],[52,9,52,10,0],[60,9,60,10,0],[61,13,61,48,0],[61,49,61,56,0],[62,13,62,68,0],[62,69,62,76,0],[63,13,63,78,0],[64,9,64,10,0]]);
    </script>
  </body>
</html>